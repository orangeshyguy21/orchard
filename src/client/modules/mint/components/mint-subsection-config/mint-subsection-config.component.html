<div class="mint-subsection-config-container">
    <div class="flex flex-column">

        <div class="sticky-nut z-index-1">
            <div class="title-l">Minting</div>
            <div class="font-size-xs orc-outline-color p-b-0-5">Configure depositing to the mint</div>
            <div class="config-category-rule"></div>
        </div>  

        <div class="p-2"> 
            <mat-card appearance="outlined" class="relative overflow-hidden">
                <mat-card-content class="orc-surface-container-low-bg">
                    <div class="flex flex-items-center flex-gap-2">
                        <div class="flex-1">
                            <orc-mint-config-form-enabled
                                [nut]="'nut4'"
                                [enabled]="form_minting.get('enabled')?.value"
                                [form_group]="form_minting"
                                (update)="onEnabledUpdate($event)"
                            ></orc-mint-config-form-enabled>
                        </div>
                        <div class="flex-1 flex flex-justify-center">
                             <div class="nut-spec flex-grow" [class.disabled]="mint_info?.nuts?.nut4?.disabled">
                                <div>NUT 04</div>
                                <div class="flex flex-gap-0-5 nut-icon-graphic" [ngClass]="mint_info?.nuts?.nut4?.disabled ? 'nut-icon-outline' : 'nut-icon-fill'">
                                    <mat-icon class="icon-lg">bolt</mat-icon>
                                    <mat-icon class="icon-lg">arrow_right_alt</mat-icon>
                                    <mat-icon class="icon-lg">payments</mat-icon>
                                </div>
                             </div>
                        </div>
                    </div>
                </mat-card-content>
            </mat-card>
        </div>

        <div class="p-h-2 p-b-2"> 
            <div class="flex flex-gap-2">
                <div class="flex-1 flex flex-column flex-gap-2">
                    <orc-mint-config-form-quote-ttl
                        [form_group]="form_minting"
                        [control_name]="'mint_ttl'"
                        (update)="onTtlUpdate($event)"
                        (cancel)="onTtlCancel($event)"
                    ></orc-mint-config-form-quote-ttl>
                </div>
                <div class="flex-1">
                    <orc-mint-quote-ttl-chart 
                        [nut]="'nut4'"
                        [loading]="data_loading"
                        [mint_quotes]="mint_quotes"
                        [locale]="locale"
                        [quote_ttl]="form_minting.get('mint_ttl')?.value"
                    ></orc-mint-quote-ttl-chart>
                </div>
            </div>
        </div>
   
        @for (unit of minting_units; track unit) {
            <div class="sticky-method z-index-1">
                <div class="flex flex-items-center flex-gap-1 p-b-0-5">
                    <div class="font-size-xs orc-outline-color">{{ unit | titlecase }} Configuration</div>
                    <orc-graphic-asset 
                        [unit]="unit" 
                        [height]="'1rem'">
                    </orc-graphic-asset>
                    <div class="font-size-xs orc-outline-color">bolt11</div>
                </div>                
            </div>

            <div class="p-h-2 p-b-2">
                <mat-card appearance="outlined" class="relative overflow-hidden">
                    <mat-card-content class="orc-surface-container-low-bg">
                        @for (method of mint_info?.nuts?.nut4?.methods; track method; let i = $index) {
                            <div class="flex flex-gap-2">
                                @if (method.unit === unit && method.method === 'bolt11') {
                                    <orc-mint-config-form-bolt11 
                                        class="flex-1"
                                        [nut]="'nut4'"
                                        [index]="i"
                                        [unit]="unit"
                                        [method]="method.method"
                                        [form_group]="form_minting"
                                        (update)="onMethodUpdate($event)"
                                        (cancel)="onMethodCancel($event)"
                                    ></orc-mint-config-form-bolt11>
                                }
                                <div class="flex-1">
                                    <orc-mint-config-method-chart 
                                        [nut]="'nut4'"
                                        [loading]="data_loading"
                                        [mint_quotes]="mint_quotes"
                                        [locale]="locale"
                                        [unit]="unit"
                                        [method]="method.method"
                                        [min_amount]="form_minting.get(unit)?.get(method.method)?.get('min_amount')?.value"
                                        [max_amount]="form_minting.get(unit)?.get(method.method)?.get('max_amount')?.value"
                                    ></orc-mint-config-method-chart>
                                </div>
                            </div>
                        }
                        @if(mint_info?.nuts?.nut4?.disabled) {
                            <div class="disabled-overlay" @fadeInOut>
                                <div class="orc-outline-color font-weight-bold">MINTING DISABLED</div>
                            </div>
                        }
                    </mat-card-content>
                </mat-card>
            </div>
        }

        <div class="sticky-nut z-index-1">
            <div class="title-l">Melting</div>
            <div class="font-size-xs orc-outline-color p-b-0-5">Configure withdrawing from the mint</div>
            <div class="config-category-rule"></div>
        </div>  

        <div class="p-2"> 
            <mat-card appearance="outlined" class="relative overflow-hidden">
                <mat-card-content class="orc-surface-container-low-bg">
                    <div class="flex flex-items-center flex-gap-2">
                        <div class="flex-1">
                            <orc-mint-config-form-enabled
                                [nut]="'nut5'"
                                [form_group]="form_melting"
                                (update)="onEnabledUpdate($event)"
                            ></orc-mint-config-form-enabled>
                        </div>
                        <div class="flex-1 flex flex-justify-center">
                            <div class="nut-spec flex-grow" [class.disabled]="mint_info?.nuts?.nut4?.disabled">
                               <div>NUT 05</div>
                               <div class="flex flex-gap-0-5 nut-icon-graphic" [ngClass]="mint_info?.nuts?.nut4?.disabled ? 'nut-icon-outline' : 'nut-icon-fill'">
                                   <mat-icon class="icon-lg">payments</mat-icon>
                                   <mat-icon class="icon-lg">arrow_right_alt</mat-icon>
                                   <mat-icon class="icon-lg">bolt</mat-icon>
                               </div>
                            </div>
                       </div>
                    </div>
                </mat-card-content>
            </mat-card>
        </div>

        <div class="p-h-2 p-b-2"> 
            <mat-card appearance="outlined" class="relative overflow-hidden">
                <mat-card-content class="orc-surface-container-low-bg">
                    <div class="flex flex-gap-2">
                        <div class="flex-1 flex flex-column flex-gap-2">
                            <orc-mint-config-form-quote-ttl
                                [form_group]="form_melting"
                                [control_name]="'melt_ttl'"
                                (update)="onTtlUpdate($event)"
                                (cancel)="onTtlCancel($event)"
                            ></orc-mint-config-form-quote-ttl>
                        </div>
                        <div class="flex-1">
                            <orc-mint-quote-ttl-chart 
                                [nut]="'nut5'"
                                [loading]="data_loading"
                                [melt_quotes]="melt_quotes"
                                [locale]="locale"
                                [quote_ttl]="form_melting.get('melt_ttl')?.value"
                            ></orc-mint-quote-ttl-chart>
                        </div>
                    </div>
                    @if(mint_info?.nuts?.nut5?.disabled) {
                        <div class="disabled-overlay" @fadeInOut>
                            <div class="orc-outline-color font-weight-bold">MELTING DISABLED</div>
                        </div>
                    }
                </mat-card-content>
            </mat-card>
        </div>

        @for (unit of melting_units; track unit) {
            <div class="sticky-method z-index-1">
                <div class="flex flex-items-center flex-gap-1 p-b-0-5">
                    <div class="font-size-xs orc-outline-color">{{ unit | titlecase }} Configuration</div>
                    <orc-graphic-asset 
                        [unit]="unit" 
                        [height]="'1rem'">
                    </orc-graphic-asset>
                    <div class="font-size-xs orc-outline-color">bolt11</div>
                </div>                
            </div>

            <div class="p-h-2 p-b-2">
                <mat-card appearance="outlined" class="relative overflow-hidden">
                    <mat-card-content class="orc-surface-container-low-bg">
                        @for (method of mint_info?.nuts?.nut4?.methods; track method; let i = $index) {
                            <div class="flex flex-gap-2">
                                @if (method.unit === unit && method.method === 'bolt11') {
                                    <orc-mint-config-form-bolt11 
                                        class="flex-1"
                                        [nut]="'nut5'"
                                        [index]="i"
                                        [unit]="unit"
                                        [method]="method.method"
                                        [form_group]="form_melting"
                                        [form_status]="form_melting.get('enabled')?.value"
                                        (update)="onMethodUpdate($event)"
                                        (cancel)="onMethodCancel($event)"
                                    ></orc-mint-config-form-bolt11>
                                }
                                <div class="flex-1">
                                    <orc-mint-config-method-chart 
                                        [nut]="'nut5'"
                                        [loading]="data_loading"
                                        [melt_quotes]="melt_quotes"
                                        [locale]="locale"
                                        [unit]="unit"
                                        [method]="method.method"
                                        [min_amount]="form_melting.get(unit)?.get(method.method)?.get('min_amount')?.value"
                                        [max_amount]="form_melting.get(unit)?.get(method.method)?.get('max_amount')?.value"
                                    ></orc-mint-config-method-chart>
                                </div>
                            </div>
                        }
                        @if(mint_info?.nuts?.nut5?.disabled) {
                            <div class="disabled-overlay" @fadeInOut>
                                <div class="orc-outline-color font-weight-bold">MELTING DISABLED</div>
                            </div>
                        }
                    </mat-card-content>
                </mat-card>
            </div>
        }

        <div class="sticky-nut z-index-1">
            <div class="title-l">Token state check</div>
            <div class="font-size-xs orc-outline-color p-b-0-5">Lorem ipsum dolor sit amet, consectetur</div>
            <div class="config-category-rule"></div>
        </div>  
    </div>
</div>