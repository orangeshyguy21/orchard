<div class="crew-form-invite-container p-t-1">
	<mat-card appearance="outlined" class="relative overflow-hidden">
		<mat-card-content class="orc-surface-container-low-bg relative">
			<div class="absolute z-index-2 top-0-5 right-0-5">
				<button mat-icon-button (click)="close.emit()">
					<mat-icon>close</mat-icon>
				</button>
			</div>

			<div class="p-b-2">
				<div class="title-l">Update User</div>
				<div class="font-size-xs orc-outline-color">Update this user's details in your crew</div>
			</div>

			<form
				class="flex flex-column flex-gap-1"
				[formGroup]="form_group()"
				(ngSubmit)="$event.preventDefault()"
				(keydown.enter)="$event.preventDefault()"
			>
				<div class="flex flex-gap-2">
					<div class="flex-1">
						<div class="flex flex-items-center flex-gap-0-5 p-b-1">
							<div class="title-form-section">User</div>
							<mat-icon class="icon-sm">info</mat-icon>
						</div>

						<div class="flex flex-gap-2">
							<orc-form-field-dynamic
								[hot]="focused_role() || form_group().get('role')?.dirty || false"
								[invalid]="form_group().get('role')?.invalid || false"
								[standalone]="false"
								(cancel)="cancel.emit('role')"
							>
								<mat-form-field
									appearance="fill"
									hideRequiredMarker="true"
									[ngClass]="
										focused_role() || form_group().get('role')?.dirty || false
											? 'orc-hot-form-field'
											: 'orc-cold-form-field'
									"
									class="orc-dynamic-form-field"
								>
									<mat-label>Role</mat-label>
									<mat-select formControlName="role">
										@for (role of role_options(); track role.value) {
											<mat-option [value]="role.value">{{ role.label }}</mat-option>
										}
									</mat-select>
								</mat-form-field>
							</orc-form-field-dynamic>

							<orc-form-field-dynamic
								class="flex-grow"
								[hot]="focused_label() || form_group().get('label')?.dirty || false"
								[invalid]="form_group().get('label')?.invalid || false"
								[standalone]="false"
								(cancel)="cancel.emit('label')"
							>
								<mat-form-field
									appearance="fill"
									hideRequiredMarker="true"
									[ngClass]="
										focused_label() || form_group().get('label')?.dirty || false
											? 'orc-hot-form-field'
											: 'orc-cold-form-field'
									"
									class="form-user-label orc-dynamic-form-field"
								>
									<mat-label>Label</mat-label>
									<textarea
										rows="1"
										matInput
										formControlName="label"
										[formAutogrow]="true"
										(focus)="focused_label.set(true)"
										(blur)="focused_label.set(false)"
									></textarea>
									@if (
										form_group().get('label')?.invalid &&
										(form_group().get('label')?.dirty || form_group().get('label')?.touched)
									) {
										<mat-error class="font-size-xs"
											>Max length is
											{{ form_group().get('label')?.getError('maxlength')?.requiredLength }} characters</mat-error
										>
									}
								</mat-form-field>
							</orc-form-field-dynamic>
						</div>
					</div>

					<div class="flex-1 flex flex-column flex-gap-1">
						<div class="flex flex-items-center flex-gap-0-5">
							<div class="title-form-section">User Status</div>
							<mat-icon class="icon-sm">info</mat-icon>
						</div>

						<div>
							<mat-slide-toggle formControlName="active">
								<div class="p-l-1">
									@if (form_group().get('active')?.value) {
										<div class="label-state label-success">Active</div>
									} @else {
										<div class="label-state label-default">Inactive</div>
									}
								</div>
							</mat-slide-toggle>
						</div>
					</div>
				</div>
			</form>
		</mat-card-content>
	</mat-card>
</div>
